(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();const F={rosso:"bg-danger",blu:"bg-primary",giallo:"bg-warning",verde:"bg-success",azzurro:"bg-info"},J=(e,t)=>{let n="<tr><th>Giorno</th>%CAMERE</tr>";const o="<th>%VALORE</th>",a=Object.keys(e);let l="";a.forEach(c=>{l+=o.replace("%VALORE",c)}),n=n.replace("%CAMERE",l),t.innerHTML=n};function R(e,t){let n=new Date(t);return n.setDate(n.getDate()+e),n.getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear()}function U(e,t){const n={weekday:"long",year:"numeric",month:"long",day:"numeric"};let o=new Date(t);return o.setDate(o.getDate()+e),o.toLocaleDateString(void 0,n)}function Y(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}const x=(e,t)=>t.findIndex(({data:n})=>n===e),q=(e,t,n)=>{let o="<tr >%VALORI</tr>";const a="<td>%DATO</td>";let l="";for(let c=0;c<=30;c++){let g=0,d="";const V=R(c,n),H=U(c,n);d+=a.replace("%DATO",Y(H));for(let b=0;b<Object.values(e).length;b++){const A=x(V,r),D=A!==-1?Object.values(e)[b]-Object.values(r[A].prenotazioni)[b]:Object.values(e)[b],C=`<div class="progress" style="height: 30px;">
  <div class="progress-bar `+Object.values(F)[g]+'" role="progressbar" aria-label="Example with label" style="width:'+D/Object.values(e)[b]*100+'%; font-size: x-large;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">'+D+`</div>
</div>`;D!==0?d+=a.replace("%DATO",C):d+=a.replace("%DATO",'<img width="40" height="40" src="Icon/calendarioPieno.svg" alt="elimina">'),g++,g==5&&(g=0)}l+=o.replace("%VALORI",d)}t.innerHTML=l},m=(e,t,n,o)=>{J(e,t),q(e,n,o)},G=(e,t)=>{let n=!1;for(let o=0;o<e.length&&(n=e[o]===t,!n);o++);return n},K=e=>{const t=[],n=Object.keys(e);for(let o=0;o<r.length;o++){const a=Object.keys(r[o].prenotazioni),l=Object.values(r[o].prenotazioni),c=r[o].data,g={};for(let d=0;d<Object.keys(e).length;d++)g[Object.keys(e)[d]]=Object.values(c)[d],G(a,n[d])?g[n[d]]=l[d]:g[n[d]]=0;t.push({data:c,prenotazioni:g})}return t},Q=`<div class="col"><div class="form-floating"><input type='number' class="form-control border-dark" value='%DISPONIBILITA' placeholder="%TITOLO2" id='%ID'><label for='%VAL'>%TITOLO</label></div></div>`,X=e=>{let t="";const n=Object.keys(e),o=Object.values(e);for(let a=0;a<n.length;a++)t+=Q.replace("%ID",o[a]).replace("%VAL",o[a]).replace("%TITOLO2",n[a]).replace("%TITOLO",n[a]).replace("%DISPONIBILITA",o[a]);return t},Z=e=>{const t=Object.values(e),n=Object.keys(e);for(let o=0;o<t.length;o++){const a=document.getElementById(t[o]).value;e[n[o]]=a}return e},B=(e,t)=>{const n=M(Object.keys(t)),o=M(Object.values(t)),a=n.indexOf(e.toUpperCase());if(a!=-1){const l={};for(let c=0;c<n.length;c++)c!=a&&(l[Object.keys(t)[c]]=o[c],console.log(Object.keys(t)[c]),console.log(o[c]));return l}else return t},M=e=>{const t=[];return e.forEach(n=>t.push(typeof n=="string"?n.toUpperCase():n)),t},$='<option value="%VALUE">%TITOLO</option>',W=e=>{let t="";for(let n=0;n<Object.keys(e).length;n++)t+=$.replace("%VALUE",n).replace("%TITOLO",Object.keys(e)[n]),t+=`
`;return t};function f(e){let t=new Date;return t.setDate(t.getDate()+e),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}function _(e,t,n,o){return console.log(n),t!==-1?Object.values(e)[n]-Object.values(o[t].prenotazioni)[n]:Object.values(e)[n]}function ee(e,t,n,o,a,l){return e!==-1?t[e].prenotazioni[n]+=o:(t.push({data:a,prenotazioni:te(l)}),t[t.length-1].prenotazioni[n]=o),t}function te(e){const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n]=0);return t}function I(e,t){fetch("https://ws.progettimolinari.it/cache/set",{method:"Post",headers:{"content-type":"application/json",key:"32fdbbd2-ad29-46dc-996e-2db287ce3248"},body:JSON.stringify({key:t,value:JSON.stringify(e)})}).then(n=>n.json()).then(n=>console.log(n)).catch(n=>console.error(n))}function P(e,t){return new Promise((n,o)=>{fetch("https://ws.progettimolinari.it/cache/get",{method:"Post",headers:{"content-type":"application/json",key:"32fdbbd2-ad29-46dc-996e-2db287ce3248"},body:JSON.stringify({key:e})}).then(a=>{n(a.json())}).catch(a=>o(a))})}function ne(e){const t=new Date;t.setHours(0,0,0,0);for(let n=0;n<e.length;n++){const o=e[n].data.split("/");if(new Date(o[2],o[1]-1,o[0])>=t)return n}return-1}const oe=document.getElementById("salvaModifiche"),ae=document.getElementById("saveModal");document.getElementById("noSaveModal");const le=new bootstrap.Modal("#modalSave"),p=document.getElementById("tableHeader"),y=document.getElementById("tableBody"),ie=document.getElementById("modificaDisponibilita"),ce=document.getElementById("visualizzaPaginaAmministrazione"),re=document.getElementById("saveModalModifiche"),se=document.getElementById("aggiungiStanza"),L=document.getElementById("tipologiaStanza"),w=document.getElementById("numeroStanze"),T=document.getElementById("nomeStanzaDaEliminare"),de=document.getElementById("confermaElimina"),j=document.getElementById("indietro"),ue=document.getElementById("avanti"),ge=document.getElementById("aggiungi");document.getElementById("modalBody");const z=document.getElementById("date");z.value=new Date().toISOString().split("T")[0];const me=document.getElementById("prossimoModal"),N=document.getElementById("select"),fe=document.getElementById("modalIndietro"),v=document.getElementById("modalTogli");document.getElementById("modalAggiungi");const pe=document.getElementById("ModalSet"),O=document.getElementById("numeri");let h=0,s=0,E=0,k=0,S=0;s===0&&(v.disabled=!0);O.innerText=s;z.min=new Date().toISOString().split("T")[0];let u=0,i={singola:10,doppia:5,tripla:3},r=[];ce.onclick=()=>{ie.innerHTML=X(i)};re.onclick=()=>{m(Z(i),p,y,f(u))};se.onclick=()=>{i[L.value]=parseInt(w.value),L.value="",w.value="",r=K(i),m(i,p,y,f(u))};de.onclick=()=>{i=B(T.value,i);for(let e=0;e<r.length;e++)r[e].prenotazioni=B(T.value,r[e].prenotazioni);T.value="",console.log(i),console.log(" :"),console.log(r),m(i,p,y,f(u))};ue.onclick=()=>{u+=30,j.disabled=!1,m(i,p,y,f(u))};j.onclick=()=>{u-=30,u==0&&(j.disabled=!0),m(i,p,y,f(u))};me.onclick=()=>{E=N.selectedIndex;let e=z.value.split("-"),t=0;parseInt(e[1])<10?t=e[1].charAt(1):t=e[1],k=e[2]+"/"+t+"/"+e[0],S=x(k,r),h=_(i,S,E,r),console.log(h),(s===h-1||h===0)&&(modalAggiungi.disabled=!0)};ge.onclick=()=>{N.innerHTML=W(i),s=0,O.innerText=s,modalAggiungi.disabled=!1,v.disabled=!0};v.onclick=()=>{modalAggiungi.disabled=!1,s===1&&(v.disabled=!0),s--,O.innerText=s};modalAggiungi.onclick=()=>{v.disabled=!1,console.log("numero attuale "+s),console.log("numero Max "+(h-1)),s===h-1&&(modalAggiungi.disabled=!0,console.log("MAX")),s++,O.innerText=s};pe.onclick=()=>{const e=Object.keys(i)[E];console.log(Object.keys(i)[E]),ee(S,r,e,s,k,i),m(i,p,y,f(u)),s=0,O.innerText=s};fe.onclick=()=>{s=0,modalAggiungi.disabled=!1,v.disabled=!0,O.innerText=s};oe.onclick=()=>{I(i,"disp"),I(r,"prenotazionePerData"),console.log("cliccato")};ae.onclick=()=>{I(i,"disp"),I(r,"prenotazionePerData"),console.log("cliccato")};setInterval(function(){le.show()},36e5);P("disp").then(e=>{console.log(JSON.parse(e.result)),i=JSON.parse(e.result),m(i,p,y,f(u))});P("prenotazionePerData").then(e=>{console.log(e),r=JSON.parse(e.result),m(i,p,y,f(u));const t=ne(r);t!==-1&&r.splice(0,t),I(r,"prenotazionePerData")});
